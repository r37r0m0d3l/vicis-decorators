{"version":3,"file":"vicis-decorators.mjs","sources":["../src/const/config.js","../src/const/serializer.js","../src/utils/clone.js","../src/config/getDefault.js","../src/utils/merge.js","../src/hooks/toJSON.js","../src/classes/Serialize.js","../src/classes/Cast.js","../src/classes/Defaults.js","../src/utils/argsAsArray.js","../src/classes/Exclude.js","../src/classes/Nullish.js","../src/classes/Omit.js","../src/classes/Order.js","../src/classes/Pick.js","../src/classes/Rename.js","../src/classes/Replace.js","../src/classes/Required.js","../src/classes/Transform.js","../src/config/validate.js","../src/functions/serialize.js","../src/functions/cast.js","../src/functions/defaults.js","../src/functions/defined.js","../src/functions/exclude.js","../src/functions/nullish.js","../src/functions/omit.js","../src/functions/pick.js","../src/functions/rename.js","../src/functions/replace.js","../src/functions/required.js","../src/functions/transform.js"],"sourcesContent":["export const CONFIG = Symbol(\"__vicis_config__\");\n","export const SERIALIZER = Symbol(\"__vicis_serializer__\");\n","import cloneDeep from \"lodash.clonedeep\";\n\n/**\n * @name clone\n * @description Recursively clones `value`.\n * @param {any} value\n * @returns {any}\n */\nexport function clone(value) {\n  return cloneDeep(value);\n}\n","import { clone } from \"../utils/clone.js\";\n\nconst vicisConfigDefault = {\n  cast: {},\n  defaults: {},\n  defined: [],\n  exclude: [],\n  nullish: {},\n  omit: [],\n  order: [],\n  pick: [],\n  sort: true,\n  rename: {},\n  replace: {},\n  required: [],\n  transform: {},\n};\n\n/**\n * @name getDefault\n * @description Get default Vicis configuration.\n * @returns {any}\n */\nexport function getDefault() {\n  return clone(vicisConfigDefault);\n}\n","import lodashMerge from \"lodash.merge\";\n\n/**\n * @name merge\n * @description Performs deep merges and tracks traversed objects.\n * @param {any} valueOne\n * @param {any} valueTwo\n * @returns {any}\n */\nexport function merge(valueOne, valueTwo) {\n  return lodashMerge(valueOne, valueTwo);\n}\n","import { CONFIG } from \"../const/config.js\";\nimport { SERIALIZER } from \"../const/serializer.js\";\n\n/**\n * @name toJSON\n * @description Mixin for serialization class.\n * @returns {any}\n */\nexport function toJSON() {\n  const asJSON = {};\n  const propertiesToSerialize = Array.from(new Set(this[CONFIG].pick));\n  propertiesToSerialize.forEach((propertyName) => {\n    asJSON[propertyName] = this[propertyName];\n  });\n  const serializedData = this[SERIALIZER].config(this[CONFIG]).data(asJSON).getData();\n  (async () => {\n    this[SERIALIZER].clear();\n  })();\n  return serializedData;\n}\n","import { Vicis } from \"vicis\";\n\nimport { CONFIG } from \"../const/config.js\";\nimport { SERIALIZER } from \"../const/serializer.js\";\n\nimport { clone } from \"../utils/clone.js\";\nimport { getDefault } from \"../config/getDefault.js\";\nimport { merge } from \"../utils/merge.js\";\nimport { toJSON } from \"../hooks/toJSON.js\";\n\n/**\n * @name Serialize\n * @description Make class ready for serialization.\n * @param {object=} config\n * @returns {Function}\n */\nexport function Serialize(config = {}) {\n  /**\n   * @param {object} target\n   * @returns {object}\n   */\n  return function (target) {\n    if (!Object.is(target.prototype.toJSON, toJSON)) {\n      target.prototype.toJSON = toJSON;\n    }\n    if (CONFIG in target.prototype) {\n      target.prototype[CONFIG] = merge(clone(target.prototype[CONFIG]), clone(config || {}));\n    } else {\n      const mergedConfig = merge(getDefault(), clone(config || {}));\n      const protoConfig = clone(target.prototype[CONFIG] || {});\n      const setConfig = merge(mergedConfig, protoConfig);\n      target.prototype[CONFIG] = setConfig;\n      target.prototype[SERIALIZER] = Vicis.factory(setConfig);\n    }\n    return target;\n  };\n}\n","import { Serialize } from \"./Serialize.js\";\n\n/**\n * @name Cast\n * @description Typecast object values to BOOLEAN, NUMERIC, INTEGER, STRING, JSON\n * @param {object.<string, string>=} propertiesToCast\n * @returns {Function}\n */\nexport function Cast(propertiesToCast) {\n  return Serialize({ cast: propertiesToCast });\n}\n","import { Serialize } from \"./Serialize.js\";\n\n/**\n * @name Defaults\n * @description In case of property has undefined value it will be replaced with value from configuration.\n * @param {object.<string, any>=} propertyDefaultValues\n * @returns {Function}\n */\nexport function Defaults(propertyDefaultValues = {}) {\n  return Serialize({ defaults: propertyDefaultValues });\n}\n","/**\n * @name argsAsArray\n * @description Mark property or getter as serializable.\n * @param {Array.<any>|any=} firstArgument\n * @param {...any} restArguments\n * @returns {Function}\n */\nexport function argsAsArray(firstArgument, ...restArguments) {\n  let args;\n  if (firstArgument !== undefined) {\n    if (Array.isArray(firstArgument)) {\n      args = [...firstArgument];\n    } else {\n      args = [firstArgument];\n    }\n  } else {\n    args = [];\n  }\n  if (restArguments.length) {\n    args = args.concat(restArguments);\n  }\n  return args;\n}\n","import { Serialize } from \"./Serialize.js\";\nimport { argsAsArray } from \"../utils/argsAsArray.js\";\n\n/**\n * @name Exclude\n * @description Remove from object listed properties.\n * @param {Array.<string|RegExp>=} propertiesToExclude\n * @param {...string|RegExp} exclude\n * @returns {Function}\n */\nexport function Exclude(propertiesToExclude, ...exclude) {\n  return Serialize({ exclude: argsAsArray(propertiesToExclude, ...exclude) });\n}\n","import { Serialize } from \"./Serialize.js\";\n\n/**\n * @name Nullish\n * @description In case of property has undefined or null value it will be replaced with value from configuration.\n * @param {object.<string, any>=} propertyNullishValues\n * @returns {Function}\n */\nexport function Nullish(propertyNullishValues = {}) {\n  return Serialize({ defaults: propertyNullishValues });\n}\n","import { Serialize } from \"./Serialize.js\";\nimport { argsAsArray } from \"../utils/argsAsArray.js\";\n\n/**\n * @name Omit\n * @description Remove from object listed properties.\n * @param {Array.<string>|string=} propertiesToOmit\n * @param {...string} omit\n * @returns {Function}\n */\nexport function Omit(propertiesToOmit, ...omit) {\n  return Serialize({ omit: argsAsArray(propertiesToOmit, ...omit) });\n}\n","import { Serialize } from \"./Serialize.js\";\nimport { argsAsArray } from \"../utils/argsAsArray.js\";\n\n/**\n * @name Order\n * @description Set order of object property names.\n * @param {Array.<string>|string=} propertiesToStreamline\n * @param {...string} order\n * @returns {Function}\n */\nexport function Order(propertiesToStreamline, ...order) {\n  return Serialize({ order: argsAsArray(propertiesToStreamline, ...order) });\n}\n","import { Serialize } from \"./Serialize.js\";\nimport { argsAsArray } from \"../utils/argsAsArray.js\";\n\n/**\n * @name Pick\n * @description Mark property or getter as serializable.\n * @param {Array.<string>|string=} propertiesToPick\n * @param {...string} pick\n * @returns {Function}\n */\nexport function Pick(propertiesToPick, ...pick) {\n  return Serialize({ pick: argsAsArray(propertiesToPick, ...pick) });\n}\n","import { Serialize } from \"./Serialize.js\";\n\n/**\n * @name Rename\n * @description Renames properties to another name and remove original\n * @param {object.<string, string>=} renamePropertyFromTo\n * @returns {Function}\n */\nexport function Rename(renamePropertyFromTo) {\n  return Serialize({ rename: renamePropertyFromTo });\n}\n","import { Serialize } from \"./Serialize.js\";\n\n/**\n * @name Replace\n * @description Overrides object values\n * @param {object.<string, *>=} replacePropertyValues\n * @returns {Function}\n */\nexport function Replace(replacePropertyValues) {\n  return Serialize({ replace: replacePropertyValues });\n}\n","import { Serialize } from \"./Serialize.js\";\nimport { argsAsArray } from \"../utils/argsAsArray.js\";\n\n/**\n * @name Required\n * @description If property defined in object - no error thrown.\n * @param {Array.<string>|string=} propertiesRequired\n * @param {...string} required\n * @returns {Function}\n */\nexport function Required(propertiesRequired, ...required) {\n  return Serialize({ required: argsAsArray(propertiesRequired, ...required) });\n}\n","import { Serialize } from \"./Serialize.js\";\n\n/**\n * @name Transform\n * @description Transform property values with function\n * @param {object.<string, Function>=} propertyValuesTransformWith\n * @returns {Function}\n */\nexport function Transform(propertyValuesTransformWith) {\n  return Serialize({ transform: propertyValuesTransformWith });\n}\n","import { Vicis } from \"vicis\";\n\nimport { CONFIG } from \"../const/config.js\";\nimport { SERIALIZER } from \"../const/serializer.js\";\n\nimport { getDefault } from \"./getDefault.js\";\n\n/**\n * @name validate\n * @description Check wherever serializable object already has Vicis serializer.\n * @param {object} instance\n * @returns {void}\n */\nexport function validate(instance) {\n  if (!instance[CONFIG]) {\n    instance[CONFIG] = getDefault();\n    instance[SERIALIZER] = Vicis.factory(instance[CONFIG]);\n  }\n}\n","import { CONFIG } from \"../const/config.js\";\n\nimport { validate } from \"../config/validate.js\";\n\n/**\n * @name serialize\n * @description Mark property or getter as serializable.\n * @param {object|string=} configOfProperty\n * @returns {Function}\n */\nexport function serialize(configOfProperty) {\n  let propertyConfig;\n  if (typeof configOfProperty === \"string\") {\n    propertyConfig = { rename: configOfProperty };\n  } else {\n    propertyConfig = { ...configOfProperty };\n  }\n  /**\n   * @param {object} instance\n   * @param {string} propertyName\n   */\n  return function (instance, propertyName /*, descriptor*/) {\n    validate(instance);\n    const hasConfig = Object.keys(propertyConfig).length > 0;\n    if (!hasConfig) {\n      instance[CONFIG].pick.push(propertyName);\n    }\n    Object.keys(propertyConfig).forEach((key) => {\n      switch (key) {\n        case \"defined\":\n        case \"exclude\":\n        case \"omit\":\n        case \"required\":\n          {\n            if (propertyConfig[key] === true) {\n              instance[CONFIG][key].push(propertyName);\n            }\n          }\n          break;\n        case \"rename\":\n          {\n            instance[CONFIG][key][propertyName] = propertyConfig.rename;\n            instance[CONFIG][\"pick\"].push(propertyConfig.rename);\n            instance[CONFIG][\"pick\"].push(propertyName);\n          }\n          break;\n        default:\n          {\n            let globalConfigProperty = instance[CONFIG][key];\n            if (Array.isArray(globalConfigProperty)) {\n              globalConfigProperty = new Set(globalConfigProperty);\n              globalConfigProperty.add(propertyConfig[key]);\n              globalConfigProperty = Array.from(globalConfigProperty);\n            } else {\n              globalConfigProperty[propertyName] = propertyConfig[key];\n            }\n            instance[CONFIG][key] = globalConfigProperty;\n          }\n          break;\n      }\n    });\n  };\n}\n","import { serialize } from \"./serialize.js\";\n\n/**\n * @name cast\n * @description Typecast object value to BOOLEAN, NUMERIC, INTEGER, STRING, JSON\n * @param {string} to\n * @returns {Function}\n */\nexport function cast(to) {\n  return serialize({ cast: to });\n}\n","import { serialize } from \"./serialize.js\";\n\n/**\n * @name defaults\n * @description In case of property has undefined value it will be replaced with value from configuration\n * @param {any} value\n * @returns {Function}\n */\nexport function defaults(value) {\n  return serialize({ defaults: value });\n}\n","import { CONFIG } from \"../const/config.js\";\n\nimport { validate } from \"../config/validate.js\";\n\n/**\n * @name defined\n * @description If value is defined in object - no error thrown.\n * @param {object} instance\n * @param {string} propertyName\n * @returns {void}\n */\nexport function defined(instance, propertyName) {\n  validate(instance);\n  instance[CONFIG][\"defined\"].push(propertyName);\n  instance[CONFIG][\"pick\"].push(propertyName);\n}\n","import { CONFIG } from \"../const/config.js\";\n\nimport { validate } from \"../config/validate.js\";\n\n/**\n * @name exclude\n * @description Remove from object listed property.\n * @param {object} instance\n * @param {string} propertyName\n * @returns {void}\n */\nexport function exclude(instance, propertyName) {\n  validate(instance);\n  instance[CONFIG][\"exclude\"].push(propertyName);\n}\n","import { serialize } from \"./serialize.js\";\n\n/**\n * @name nullish\n * @description In case of property has undefined or null value it will be replaced with value from configuration\n * @param {any} value\n * @returns {Function}\n */\nexport function nullish(value) {\n  return serialize({ nullish: value });\n}\n","import { CONFIG } from \"../const/config.js\";\n\nimport { validate } from \"../config/validate.js\";\n\n/**\n * @name omit\n * @description Remove property from object. Applies before all other transformations.\n * @param {object} instance\n * @param {string} propertyName\n * @returns {void}\n */\nexport function omit(instance, propertyName) {\n  validate(instance);\n  instance[CONFIG][\"omit\"].push(propertyName);\n}\n","import { CONFIG } from \"../const/config.js\";\n\nimport { validate } from \"../config/validate.js\";\n\n/**\n * @name pick\n * @description Mark property or getter as serializable.\n * @param {object} instance\n * @param {string} propertyName\n * @returns {void}\n */\nexport function pick(instance, propertyName) {\n  validate(instance);\n  instance[CONFIG][\"pick\"].push(propertyName);\n}\n","import { serialize } from \"./serialize.js\";\n\n/**\n * @name rename\n * @description Rename property to another name and remove original.\n * @param {string} name\n * @returns {Function}\n */\nexport function rename(name) {\n  return serialize(name);\n}\n","import { serialize } from \"./serialize.js\";\n\n/**\n * @name replace\n * @description Overrides object value.\n * @param {any} value\n * @returns {Function}\n */\nexport function replace(value) {\n  return serialize({ replace: value });\n}\n","import { CONFIG } from \"../const/config.js\";\n\nimport { validate } from \"../config/validate.js\";\n\n/**\n * @name required\n * @description If property defined in object - no error thrown.\n * @param {object} instance\n * @param {string} propertyName\n * @returns {void}\n */\nexport function required(instance, propertyName) {\n  validate(instance);\n  instance[CONFIG][\"required\"].push(propertyName);\n}\n","import { serialize } from \"./serialize.js\";\n\n/**\n * @name transform\n * @description Transform property value with function.\n * @param {Function} transformer\n * @returns {Function}\n */\nexport function transform(transformer) {\n  return serialize({ transform: transformer });\n}\n"],"names":["CONFIG","Symbol","SERIALIZER","clone","value","cloneDeep","vicisConfigDefault","cast","defaults","defined","exclude","nullish","omit","order","pick","sort","rename","replace","required","transform","getDefault","merge","valueOne","valueTwo","lodashMerge","toJSON","asJSON","Array","from","Set","this","forEach","propertyName","serializedData","config","data","getData","clear","Serialize","target","Object","is","prototype","mergedConfig","setConfig","Vicis","factory","Cast","propertiesToCast","Defaults","propertyDefaultValues","argsAsArray","firstArgument","restArguments","args","undefined","isArray","length","concat","Exclude","propertiesToExclude","Nullish","propertyNullishValues","Omit","propertiesToOmit","Order","propertiesToStreamline","Pick","propertiesToPick","Rename","renamePropertyFromTo","Replace","replacePropertyValues","Required","propertiesRequired","Transform","propertyValuesTransformWith","validate","instance","serialize","configOfProperty","propertyConfig","keys","push","key","globalConfigProperty","add","to","name","transformer"],"mappings":"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"}