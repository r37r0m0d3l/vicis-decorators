"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var e=require("vicis"),t=_interopDefault(require("lodash.clonedeep")),r=_interopDefault(require("lodash.merge"));const i=Symbol("__vicis_config__"),n=Symbol("__vicis_serializer__");function clone(e){return t(e)}const o={cast:{},defaults:{},defined:[],exclude:[],omit:[],order:[],pick:[],sort:!0,rename:{},replace:{},required:[],transform:{}};function getDefaultConfig(){return clone(o)}function validateConfig(t){t[i]||(t[i]=getDefaultConfig(),t[n]=e.Vicis.factory(t[i]))}function serialize(e){let t;return t="string"==typeof e?{rename:e}:{...e},function(e,r){validateConfig(e),Object.keys(t).length>0&&e[i].pick.push(r),Object.keys(t).forEach(n=>{switch(n){case"defined":case"exclude":case"omit":!0===t[n]&&e[i][n].push(r);break;case"rename":e[i][n][r]=t.rename,e[i].pick.push(t.rename);break;case"required":!0===t[n]&&e[i][n].push(r);break;default:{let o=e[i][n];Array.isArray(o)?(o=new Set(o),o.add(t[n]),o=Array.from(o)):o[r]=t[n],e[i][n]=o}}})}}function merge(e,t){return r(e,t)}function toJSON(){const e=new Object(null);Array.from(new Set(this[i].pick)).forEach(t=>{e[t]=this[t]});const t=this[n].data(e).getData();return this[n].clear(),t}exports.cast=function cast(e){return serialize({cast:e})},exports.defaults=function defaults(e){return serialize({defaults:e})},exports.defined=function defined(e,t){validateConfig(e),e[i].defined.push(t),e[i].pick.push(t)},exports.exclude=function exclude(e,t){validateConfig(e),e[i].exclude.push(t)},exports.omit=function omit(e,t){validateConfig(e),e[i].omit.push(t)},exports.rename=function rename(e){return serialize(e)},exports.replace=function replace(e){return serialize({replace:e})},exports.serializable=function serializable(t){return function(r){const o=merge(getDefaultConfig(),clone(t||{})),a=merge(o,clone(r.prototype[i]||{}));return r.prototype[i]=a,r.prototype[n]=e.Vicis.factory(a),r.prototype.toJSON=toJSON,r}},exports.serialize=serialize,exports.transform=function transform(e){return serialize({transform:e})};
//# sourceMappingURL=vicis-decorators.cjs.map
