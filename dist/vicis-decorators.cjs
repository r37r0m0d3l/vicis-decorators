"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("vicis"),r=require("lodash.clonedeep"),t=require("lodash.merge");function _interopDefaultLegacy(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=_interopDefaultLegacy(r),n=_interopDefaultLegacy(t);const a=Symbol("__vicis_config__"),o=Symbol("__vicis_serializer__");function clone(e){return i.default(e)}const s={cast:{},defaults:{},defined:[],exclude:[],nullish:{},omit:[],order:[],pick:[],sort:!0,rename:{},replace:{},required:[],transform:{}};function getDefault(){return clone(s)}function merge(e,r){return n.default(e,r)}function toJSON(){const e={};Array.from(new Set(this[a].pick)).forEach((r=>{e[r]=this[r]}));const r=this[o].config(this[a]).data(e).getData();return(async()=>{this[o].clear()})(),r}function Serialize(r={}){return function(t){if(Object.is(t.prototype.toJSON,toJSON)||(t.prototype.toJSON=toJSON),a in t.prototype)t.prototype[a]=merge(clone(t.prototype[a]),clone(r||{}));else{const i=merge(getDefault(),clone(r||{})),n=merge(i,clone(t.prototype[a]||{}));t.prototype[a]=n,t.prototype[o]=e.Vicis.factory(n)}return t}}function argsAsArray(e,...r){let t;return t=void 0!==e?Array.isArray(e)?[...e]:[e]:[],r.length&&(t=t.concat(r)),t}function validate(r){r[a]||(r[a]=getDefault(),r[o]=e.Vicis.factory(r[a]))}function serialize(e){let r;return r="string"==typeof e?{rename:e}:{...e},function(e,t){validate(e);Object.keys(r).length>0||e[a].pick.push(t),Object.keys(r).forEach((i=>{switch(i){case"defined":case"exclude":case"omit":case"required":!0===r[i]&&e[a][i].push(t);break;case"rename":e[a][i][t]=r.rename,e[a].pick.push(r.rename),e[a].pick.push(t);break;default:{let n=e[a][i];Array.isArray(n)?(n=new Set(n),n.add(r[i]),n=Array.from(n)):n[t]=r[i],e[a][i]=n}}}))}}exports.Cast=function Cast(e){return Serialize({cast:e})},exports.Defaults=function Defaults(e={}){return Serialize({defaults:e})},exports.Exclude=function Exclude(e,...r){return Serialize({exclude:argsAsArray(e,...r)})},exports.Nullish=function Nullish(e={}){return Serialize({defaults:e})},exports.Omit=function Omit(e,...r){return Serialize({omit:argsAsArray(e,...r)})},exports.Order=function Order(e,...r){return Serialize({order:argsAsArray(e,...r)})},exports.Pick=function Pick(e,...r){return Serialize({pick:argsAsArray(e,...r)})},exports.Rename=function Rename(e){return Serialize({rename:e})},exports.Replace=function Replace(e){return Serialize({replace:e})},exports.Required=function Required(e,...r){return Serialize({required:argsAsArray(e,...r)})},exports.Serialize=Serialize,exports.Transform=function Transform(e){return Serialize({transform:e})},exports.cast=function cast(e){return serialize({cast:e})},exports.defaults=function defaults(e){return serialize({defaults:e})},exports.defined=function defined(e,r){validate(e),e[a].defined.push(r),e[a].pick.push(r)},exports.exclude=function exclude(e,r){validate(e),e[a].exclude.push(r)},exports.nullish=function nullish(e){return serialize({nullish:e})},exports.omit=function omit(e,r){validate(e),e[a].omit.push(r)},exports.pick=function pick(e,r){validate(e),e[a].pick.push(r)},exports.rename=function rename(e){return serialize(e)},exports.replace=function replace(e){return serialize({replace:e})},exports.required=function required(e,r){validate(e),e[a].required.push(r)},exports.serialize=serialize,exports.transform=function transform(e){return serialize({transform:e})};
//# sourceMappingURL=vicis-decorators.cjs.map
