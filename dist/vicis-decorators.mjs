import{Vicis as e}from"vicis";import t from"lodash.clonedeep";import r from"lodash.merge";const n=Symbol("__vicis_config__"),i=Symbol("__vicis_serializer__");function clone(e){return t(e)}const o={cast:{},defaults:{},defined:[],exclude:[],omit:[],order:[],pick:[],sort:!0,rename:{},replace:{},required:[],transform:{}};function getDefaultConfig(){return clone(o)}function validateConfig(t){t[n]||(t[n]=getDefaultConfig(),t[i]=e.factory(t[n]))}function serialize(e){let t;return t="string"==typeof e?{rename:e}:{...e},function(e,r){validateConfig(e),Object.keys(t).length>0&&e[n].pick.push(r),Object.keys(t).forEach(i=>{switch(i){case"defined":case"exclude":case"omit":!0===t[i]&&e[n][i].push(r);break;case"rename":e[n][i][r]=t.rename,e[n].pick.push(t.rename);break;case"required":!0===t[i]&&e[n][i].push(r);break;default:{let o=e[n][i];Array.isArray(o)?(o=new Set(o),o.add(t[i]),o=Array.from(o)):o[r]=t[i],e[n][i]=o}}})}}function cast(e){return serialize({cast:e})}function defaults(e){return serialize({defaults:e})}function defined(e,t){validateConfig(e),e[n].defined.push(t),e[n].pick.push(t)}function exclude(e,t){validateConfig(e),e[n].exclude.push(t)}function omit(e,t){validateConfig(e),e[n].omit.push(t)}function rename(e){return serialize(e)}function replace(e){return serialize({replace:e})}function merge(e,t){return r(e,t)}function toJSON(){const e=new Object(null);Array.from(new Set(this[n].pick)).forEach(t=>{e[t]=this[t]});const t=this[i].data(e).getData();return(async()=>{this[i].clear()})(),t}function serializable(t){return function(r){const o=merge(getDefaultConfig(),clone(t||{})),a=merge(o,clone(r.prototype[n]||{}));return r.prototype[n]=a,r.prototype[i]=e.factory(a),r.prototype.toJSON=toJSON,r}}function transform(e){return serialize({transform:e})}export{cast,defaults,defined,exclude,omit,rename,replace,serializable,serialize,transform};
//# sourceMappingURL=vicis-decorators.mjs.map
